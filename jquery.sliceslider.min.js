/**
 * SliceSlider
 * @version 0.1
 * @author Pavel Khoroshkov aka pgood
 * @link https://github.com/pgooood/sliceslider
 */
!function($){$.fn.sliceslider=function(options){function slideshow(t){this.slides=[],this.current=0,this.timeOutId=null,this.state=!1,this.block=!1,this.isRunning=function(){return this.state},this.setCurrentSlide=function(t){try{for(var i=0;i<this.slides.length;i++)this.slides[i].setIndex(settings.zIndex-1);this.getSlide(t).setIndex(settings.zIndex+1),this.getSlide(this.current).setIndex(settings.zIndex),this.current=t}catch(e){console.log('setCurrentSlide: Slide "'+t+'" not found')}},this.getNextSlideIndex=function(){return this.current+1==this.slides.length?0:this.current+1},this.getPrevSlideIndex=function(){return this.current-1<0?this.slides.length-1:this.current-1},this.getSlide=function(t){return this.slides[t]},this.setSlide=function(t,i){this.slides[t]=i},this.getSlideMethod=function(){if(settings.randomMethod){var t=function(t,i){return Math.floor(arguments.length>1?(i-t+1)*Math.random()+t:(t+1)*Math.random())}(0,settings.useMethod.length-1);return settings.useMethod[t]}return("undefined"==typeof this.methodCounter||this.methodCounter>=settings.useMethod.length)&&(this.methodCounter=0),settings.useMethod[this.methodCounter++]},this.initSlides=function(){var i;if(this.slides.length){for(var e=0;e<t.length;e++)this.slides[e].remove();this.slides=[]}for(var e=0,s=0;e<t.length;e++)(i=this.createSlide(t.get(e)))&&(this.slides[s++]=i);for(var e=0,n=this.slides.length;n>e;e++)this.slides[e].setIndex(e?settings.zIndex+e-1:settings.zIndex+n-1),$(this.slides[e].getImg()).css("visibility","hidden");this.setCurrentSlide(0),this.slides[0].showCaption()},this.createSlide=function(t,i){return i||(i=this.getSlideMethod()),new settings.slides[i](t)},this.showSlide=function(t,i){if(!this.block){var e=this,s=e.getSlide(t),n=s.getIndex(),h=this.isRunning();s.remove(),this.slides[t]=s=this.createSlide(s.$e),s.setIndex(n),s.hide(),e.setCurrentSlide(t),e.block=!0,h&&!i&&e.stop(),s.show(function(){e.block=!1,i?i():h&&e.start()}),settings.onchange&&settings.onchange(t)}},this.start=function(){if(!this.isRunning()){this.state=!0;var t=this;!function(){var i=arguments.callee;t.isRunning()&&(t.timeOutId=window.setTimeout(function(){t.showSlide(t.getNextSlideIndex(),i)},settings.slideShowDelay))}()}},this.startNoTimeout=function(){var t=this;t.isRunning()||t.showSlide(t.getNextSlideIndex(),function(){t.start(arguments.callee)})},this.stop=function(){this.timeOutId&&(window.clearTimeout(this.timeOutId),this.timeOutId=null),this.state=!1},this.next=function(){this.showSlide(this.getNextSlideIndex())},this.prev=function(){this.showSlide(this.getPrevSlideIndex())},this.initSlides(),settings.autorun&&this.start()}var isIE7=-1!=navigator.appVersion.indexOf("MSIE 7."),rand=function(t,i){return Math.floor(arguments.length>1?(i-t+1)*Math.random()+t:(t+1)*Math.random())},settings=$.extend({blankDiv:$('<div style="border:0;background:none;position:absolute;padding:0;margin:0;left:auto;right:auto;bottom:auto;top:auto;overflow:visible;"></div>'),autorun:!1,buttonStartSlideShow:null,buttonStopSlideShow:null,buttonNext:null,buttonPrev:null,slideShowDelay:3e3,zIndex:1,captionPosition:"bottom",useMethod:["blocks02","blocks01","verticalCol","verticalColOpposite","verticalColLouvers","horizontalCol","horizontalColOpposite","horizontalColLouvers"],randomMethod:!1,onchange:null},options),piece={$e:null,callback:null,nextPiece:null,width:null,height:null,setWidth:function(t){this.width=t,this.$e.css("width",t)},setHeight:function(t){this.height=t,this.$e.css("height",t)},setCallback:function(t){this.callback=t},setNextPiece:function(t){this.nextPiece=t},appendTo:function(t){this.$e&&this.$e.appendTo(t)},init:function(t,i){this.$e=settings.blankDiv.clone(),this.$e.css({background:'#ccc url("'+t+'") no-repeat',top:i[0],right:i[1],bottom:i[2],left:i[3]})}},pieceSlice={getShowMethod:function(t,i){return function(){var e=this;this.$e.animate(t,i.speed,this.callback?function(){e.callback()}:null),this.nextPiece&&(i.nextPieceDelay?window.setTimeout(function(){e.nextPiece.show()},i.speed*i.nextPieceDelay):e.nextPiece.show())}},initCol:function(t,i,e,s,n,h,o){$.extend(this,piece);var c=[0,"auto","auto",0];switch(h){case 2:case 0:this.setWidth=function(i){this.width=Math.ceil(i/n.numPieces),this.$e.css({width:this.width,"background-position":"-"+t*this.width+"px "+(o?"100%":0),left:t*this.width})};break;case 3:case 1:this.setHeight=function(i){this.height=Math.ceil(i/n.numPieces),this.$e.css({height:this.height,"background-position":(o?"100%":0)+" -"+t*this.height+"px",top:t*this.height})}}switch(h){case 3:case 0:o&&(c=["auto","auto",0,0]),this.hide=function(){this.$e.height(0),this.$e.css("opacity",.2)};break;case 2:case 1:o&&(c=[0,0,"auto","auto"]),this.hide=function(){this.$e.width(0),this.$e.css("opacity",.2)}}switch(this.init(i,c),this.setWidth(e),this.setHeight(s),h){case 3:case 0:this.show=this.getShowMethod({height:this.height,opacity:1},n);break;case 2:case 1:this.show=this.getShowMethod({width:this.width,opacity:1},n)}}},slide={getWidth:function(){return this.$getImg().width()},getHeight:function(){return this.$getImg().height()},getIndex:function(){return parseInt(this.$s.css("z-index"))},setIndex:function(t){if(this.$s.css("z-index",t),isIE7){var i=function(t){for(;t=t.parentNode;)if("figure"==t.tagName.toLowerCase())return t}(this.$s.get(0));$(i).css("z-index",t)}},setCaption:function(t){$(t).length&&(this.$caption=$(t).clone(),this.$caption.css({"z-index":settings.zIndex+1,position:"absolute",top:"auto",right:"auto",bottom:"auto",left:"auto"}),$(t).hide())},getSrc:function(){return this.$getImg().attr("src")},$getImg:function(){return this.$img},getImg:function(){return this.$getImg().get(0)},$getFigure:function(){return this.$e},showCaption:function(){if(this.$caption){this.$s.append(this.$caption);var t=this.$caption.data("position")||settings.captionPosition;switch(this.$caption.show(),t){case"top":this.$caption.css({top:-1*this.$caption.outerHeight(),bottom:"auto",left:0,right:0}),this.$caption.animate({top:0});break;case"bottom":this.$caption.css({bottom:-1*this.$caption.outerHeight(),top:"auto",left:0,right:0}),this.$caption.animate({bottom:0});break;case"left":this.$caption.css({top:0,bottom:0,left:-1*this.$caption.outerWidth(),right:"auto"}),this.$caption.animate({left:0});break;case"right":this.$caption.css({top:0,bottom:0,right:-1*this.$caption.outerWidth(),left:"auto"}),this.$caption.animate({right:0})}}},hideCapption:function(){this.$caption&&this.$caption.remove()},show:function(t){var i=this;this.pieces[this.pieces.length-1].setCallback(function(){t&&t(),i.showCaption()}),this.pieces[0].show()},hide:function(){this.hideCapption();for(var t=0;t<this.pieces.length;t++)this.pieces[t].hide()},init:function(t){if(this.$e=$(t),this.$img=$(this.$e.find("img")[0]),this.$s=settings.blankDiv.clone(),this.setCaption(this.$e.find(">figcaption")),this.pieces=[],this.callback=null,this.$s.css({width:this.getWidth(),height:this.getHeight(),overflow:"hidden"}),this.linkMode="a"==this.$getImg().parent().get(0).tagName.toLowerCase(),this.linkMode?this.getImage().parent().before(this.$s):this.$getImg().before(this.$s),this.initPieces(),this.linkMode)for(var i=0;i<this.pieces.length;i++)this.pieces[i].$e.click(function(t){return function(){t.click()}}(this.$getImg())),$(this.pieces[i].$e).css("cursor","pointer")},remove:function(){this.$s.remove()}},slideSlice={initSlice:function(e,name,numClasses){$.extend(this,slide),this.initPieces=function(){if(!this.pieces.length){eval("var conf=settings.pieces."+name);for(var width=this.getWidth(),height=this.getHeight(),i=0;i<conf.numPieces;i++)this.pieces[i]=new conf["class"+(numClasses>1?i%numClasses:"")](i,this.getSrc(),width,height,conf),i&&this.pieces[i-1].setNextPiece(this.pieces[i]),this.pieces[i].appendTo(this.$s)}},this.init(e)}},setConf=function(t,i){settings.pieces[t]="object"==typeof settings[t]?$.extend(i,settings[t]):i};return settings.slides={},settings.pieces={},setConf("verticalCol",{numPieces:22,speed:300,nextPieceDelay:.3}),setConf("verticalColOpposite",{numPieces:30,speed:300,nextPieceDelay:.1}),setConf("verticalColLouvers",{numPieces:20,speed:300,nextPieceDelay:.3}),setConf("horizontalCol",{numPieces:14,speed:300,nextPieceDelay:.3}),setConf("horizontalColOpposite",{numPieces:15,speed:400,nextPieceDelay:.1}),setConf("horizontalColLouvers",{numPieces:10,speed:300,nextPieceDelay:.3}),setConf("blocks01",{numPiecesH:10,numPiecesV:5,speed:400,nextPieceDelay:.3}),setConf("blocks02",{numPiecesH:12,numPiecesV:6,speed:400,nextPieceDelay:.3}),settings.pieces.blocks02["class"]=settings.pieces.blocks01["class"]=function(t,i,e,s,n){$.extend(this,piece),this.setWidth=function(i){this.width=Math.ceil(i/n.numPiecesH),this.$e.css({width:this.width,left:t%n.numPiecesH*this.width})},this.setHeight=function(i){this.height=Math.ceil(i/n.numPiecesV),this.$e.css({height:this.height,top:parseInt(t/n.numPiecesH)*this.height})},this.show=function(){if(!this.state){this.state=!0;var t,i=this,e={width:this.width,height:this.height,opacity:1};if(this.$e.animate(e,n.speed,this.callback?function(){i.callback()}:null),this.nextPiece){this.nextPiece.length||(this.nextPiece=[this.nextPiece]);for(var s=0;s<this.nextPiece.length;s++)(t=this.nextPiece[s])&&(n.nextPieceDelay?window.setTimeout(function(t){return function(){t.show()}}(t),n.speed*n.nextPieceDelay):t.show())}}},this.hide=function(){this.$e.css({width:0,height:0,opacity:.2}),this.state=!1},this.init(i,pos=[0,0,"auto","auto"]),this.setWidth(e),this.setHeight(s),this.$e.css({background:"#fff url("+i+") no-repeat -"+t%n.numPiecesH*this.width+"px -"+parseInt(t/n.numPiecesH)*this.height+"px"})},settings.slides.blocks01=function(t,i){$.extend(this,slide),this.initPieces=function(){if(!this.pieces.length){for(var t=settings.pieces.blocks01,i=this.getWidth(),e=this.getHeight(),s=t.numPiecesH*t.numPiecesV,n=0;s>n;n++)this.pieces[n]=new t["class"](n,this.getSrc(),i,e,t),this.pieces[n].appendTo(this.$s);for(var n=0;s>n;n++)n&&n%t.numPiecesH&&this.pieces[n-1].setNextPiece(this.pieces[n])}},this.show=function(t){var i=this,e=settings.pieces.blocks01;this.pieces[this.pieces.length-1].setCallback(function(){t&&t(),i.showCaption()});for(var s=0;s<e.numPiecesV;s++)window.setTimeout(function(t){return function(){t.show()}}(this.pieces[s*e.numPiecesH]),100*s)},this.init(t)},settings.slides.blocks02=function(t,i){$.extend(this,slide),this.startIndex=0,this.initPieces=function(){if(!this.pieces.length){for(var t=settings.pieces.blocks02,i=this.getWidth(),e=this.getHeight(),s=t.numPiecesH*t.numPiecesV,n=this.getSequence(s),h=0;s>h;h++)this.pieces[h]=new t["class"](h,this.getSrc(),i,e,t),this.pieces[h].appendTo(this.$s),this.pieces[h].hide=function(){this.$e.css({opacity:0})};this.startIndex=n.controlPoints(Math.round(s/16));for(var o,h=n.next();"undefined"!=typeof(o=n.next());)this.pieces[h].setNextPiece(this.pieces[o]),h=o}},this.show=function(t){var i=this;settings.pieces.blocks02;this.pieces[this.pieces.length-1].setCallback(function(){t&&t(),i.showCaption()});for(var e=0;e<this.startIndex.length;e++)this.pieces[this.startIndex[e]].show()},this.getSequence=function(t){return new function(t){this.get=function(t){var i,e,s,n=this.ar.length,h=[],o=0;do e=rand(0,n-1),i=this.ar[e],o++;while(t==i&&8>o);for(var s=0;n>s;s++)s!=e&&h.push(this.ar[s]);return this.ar=h,i},this.next=function(){return this.arRes.shift()},this.controlPoints=function(t){var i=0,e=Math.ceil(this.arRes.length/t),s=[];if(e>0)for(;i<this.arRes.length;)s.push(this.arRes[i]),i+=e;return s},this.length=t,this.ar=[],this.arRes=[];for(var i=0;t>i;i++)this.ar.push(i);for(var i=0;t>i;i++)this.arRes.push(this.get(i))}(t)},this.init(t)},settings.pieces.verticalColOpposite.class0=settings.pieces.verticalCol["class"]=function(t,i,e,s,n){$.extend(this,pieceSlice),this.initCol(t,i,e,s,n,0,0)},settings.pieces.verticalColOpposite.class1=function(t,i,e,s,n){$.extend(this,pieceSlice),this.initCol(t,i,e,s,n,0,1)},settings.pieces.verticalColLouvers["class"]=function(t,i,e,s,n){$.extend(this,pieceSlice),this.initCol(t,i,e,s,n,2,0)},settings.pieces.horizontalColOpposite.class0=settings.pieces.horizontalCol["class"]=function(t,i,e,s,n){$.extend(this,pieceSlice),this.initCol(t,i,e,s,n,1,0)},settings.pieces.horizontalColOpposite.class1=function(t,i,e,s,n){$.extend(this,pieceSlice),this.initCol(t,i,e,s,n,1,1)},settings.pieces.horizontalColLouvers["class"]=function(t,i,e,s,n){$.extend(this,pieceSlice),this.initCol(t,i,e,s,n,3,0)},settings.slides.verticalCol=function(t,i){$.extend(this,slideSlice),this.initSlice(t,"verticalCol")},settings.slides.verticalColLouvers=function(t){$.extend(this,slideSlice),this.initSlice(t,"verticalColLouvers")},settings.slides.horizontalColLouvers=function(t){$.extend(this,slideSlice),this.initSlice(t,"horizontalColLouvers")},settings.slides.horizontalCol=function(t){$.extend(this,slideSlice),this.initSlice(t,"horizontalCol")},settings.slides.horizontalColOpposite=function(t){$.extend(this,slideSlice),this.initSlice(t,"horizontalColOpposite",2)},settings.slides.verticalColOpposite=function(t){$.extend(this,slideSlice),this.initSlice(t,"verticalColOpposite",2)},new slideshow(this)}}(jQuery);